<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÍµêÌöå MBTI ÏºÄÎØ∏ Ï≤¥ÌÅ¨</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíï</text></svg>">
    <meta name="description" content="ÍµêÌöå Í≥µÎèôÏ≤¥Î•º ÏúÑÌïú MBTI ÏºÄÎØ∏ Ï≤¥ÌÅ¨ ÏÑúÎπÑÏä§">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // SVG ÏïÑÏù¥ÏΩò Ïª¥Ìè¨ÎÑåÌä∏Îì§
        const Heart = ({ className, onClick }) => (
            <svg className={className} onClick={onClick} fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
        );

        const Settings = ({ className, onClick }) => (
            <svg className={className} onClick={onClick} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
        );

        const List = ({ className, onClick }) => (
            <svg className={className} onClick={onClick} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                <line x1="3" y1="18" x2="3.01" y2="18"></line>
            </svg>
        );

        const Download = ({ className, onClick }) => (
            <svg className={className} onClick={onClick} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
            </svg>
        );

        const ArrowRight = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12,5 19,12 12,19"></polyline>
            </svg>
        );

        const Star = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
            </svg>
        );

        const Sparkles = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 3l1.5 1.5L5 6 3.5 4.5 5 3zM19 17l1.5 1.5L19 20l-1.5-1.5L19 17zM7.5 7.5L9 9l-1.5 1.5L6 9l1.5-1.5zM16.5 16.5L18 18l-1.5 1.5L15 18l1.5-1.5z"/>
        );

        const MapPin = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
        );

        const BookOpen = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
        );

        const MessageCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
        );

        const Users = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
        );

        const HandHeart = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
            </svg>
        );

        // Î©îÏù∏ Ïï± Ïª¥Ìè¨ÎÑåÌä∏
        const MBTIChemistryChecker = () => {
            const [currentStep, setCurrentStep] = useState('input');
            const [person1, setPerson1] = useState({ name: '', mbti: '' });
            const [person2, setPerson2] = useState({ name: '', mbti: '' });
            const [result, setResult] = useState(null);
            const [testHistory, setTestHistory] = useState([]);
            const [showHistory, setShowHistory] = useState(false);
            const [showCelebration, setShowCelebration] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [googleSheetsUrl, setGoogleSheetsUrl] = useState('');

            const mbtiTypes = [
                'INTJ', 'INTP', 'ENTJ', 'ENTP',
                'INFJ', 'INFP', 'ENFJ', 'ENFP',
                'ISTJ', 'ISFJ', 'ESTJ', 'ESFJ',
                'ISTP', 'ISFP', 'ESTP', 'ESFP'
            ];

            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Í∏∞Î°ù Î∂àÎü¨Ïò§Í∏∞
            useEffect(() => {
                const savedHistory = JSON.parse(localStorage.getItem('mbtiChemistryHistory') || '[]');
                const savedUrl = localStorage.getItem('googleSheetsUrl') || '';
                setTestHistory(savedHistory);
                setGoogleSheetsUrl(savedUrl);
            }, []);

            // Google SheetsÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            const saveToGoogleSheets = async (data) => {
                if (!googleSheetsUrl) return false;
                
                try {
                    await fetch(googleSheetsUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            person1_name: data.person1.name,
                            person1_mbti: data.person1.mbti,
                            person2_name: data.person2.name,
                            person2_mbti: data.person2.mbti,
                            score: data.score,
                            date: data.date,
                            time: data.time,
                            timestamp: new Date().toISOString()
                        })
                    });
                    return true;
                } catch (error) {
                    console.log('Google Sheets Ï†ÄÏû• Ïã§Ìå®:', error);
                    return false;
                }
            };

            // Í∏∞Î°ù Ï†ÄÏû•ÌïòÍ∏∞
            const saveToHistory = async (result) => {
                const newRecord = {
                    id: Date.now(),
                    person1: person1,
                    person2: person2,
                    score: result.overall,
                    date: new Date().toLocaleDateString('ko-KR'),
                    time: new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' })
                };
                
                const updatedHistory = [newRecord, ...testHistory].slice(0, 50);
                setTestHistory(updatedHistory);
                localStorage.setItem('mbtiChemistryHistory', JSON.stringify(updatedHistory));
                
                await saveToGoogleSheets(newRecord);
            };

            // MBTI ÏºÄÎØ∏ Í≥ÑÏÇ∞ Î°úÏßÅ
            const calculateChemistry = (mbti1, mbti2) => {
                const compatibility = {
                    'ENFP-INFJ': 95, 'INFJ-ENFP': 95,
                    'ESFJ-ISFP': 90, 'ISFP-ESFJ': 90,
                    'ENTJ-INTP': 88, 'INTP-ENTJ': 88,
                    'ESTJ-ISFJ': 87, 'ISFJ-ESTJ': 87,
                    'ENFJ-ESTP': 75, 'ESTP-ENFJ': 75,
                    'INFP-ENFJ': 78, 'ENFJ-INFP': 78,
                    'ISTJ-ESFP': 72, 'ESFP-ISTJ': 72,
                    'ISTP-ENTJ': 74, 'ENTJ-ISTP': 74,
                    'INTJ-ESFP': 45, 'ESFP-INTJ': 45,
                    'INTP-ESFJ': 48, 'ESFJ-INTP': 48,
                    'ISFP-ESTJ': 50, 'ESTJ-ISFP': 50,
                    'ENTP-ISFJ': 52, 'ISFJ-ENTP': 52,
                };

                const key = `${mbti1}-${mbti2}`;
                if (mbti1 === mbti2) return 85;
                if (compatibility[key]) return compatibility[key];
                
                let score = 50;
                if ((mbti1[0] === 'E' && mbti2[0] === 'I') || (mbti1[0] === 'I' && mbti2[0] === 'E')) score += 15;
                if (mbti1[1] === mbti2[1]) score += 10;
                if (mbti1[2] === mbti2[2]) score += 5;
                if (mbti1[3] === mbti2[3]) score += 10;
                
                return Math.min(score, 95);
            };

            const getDetailedScores = (mbti1, mbti2) => {
                const baseScore = calculateChemistry(mbti1, mbti2);
                return {
                    travel: Math.min(baseScore + Math.floor(Math.random() * 20) - 10, 100),
                    faith: Math.min(baseScore + Math.floor(Math.random() * 15) - 7, 100),
                    conversation: Math.min(baseScore + Math.floor(Math.random() * 25) - 12, 100),
                    teamwork: Math.min(baseScore + Math.floor(Math.random() * 20) - 10, 100),
                    service: Math.min(baseScore + Math.floor(Math.random() * 15) - 7, 100)
                };
            };

            const getChemistryMessage = (mbti1, mbti2, score) => {
                const messages = {
                    'ENFP-INFJ': "ÏôÄ! ÏòÅÍ∞êÏùÑ Ï£ºÍ≥†Î∞õÎäî ÌôòÏÉÅÏùò ÏºÄÎØ∏! ENFPÏùò Ï∞ΩÏùòÏ†Å ÏóêÎÑàÏßÄÏôÄ INFJÏùò ÍπäÏùÄ ÌÜµÏ∞∞Î†•Ïù¥ ÎßåÎÇòÎ©¥ Ï†ïÎßê ÌäπÎ≥ÑÌïú ÏùºÎì§Ïù¥ ÏùºÏñ¥ÎÇ† Í±∞ÏòàÏöî!",
                    'INFJ-ENFP': "ÏôÄ! ÏòÅÍ∞êÏùÑ Ï£ºÍ≥†Î∞õÎäî ÌôòÏÉÅÏùò ÏºÄÎØ∏! ENFPÏùò Ï∞ΩÏùòÏ†Å ÏóêÎÑàÏßÄÏôÄ INFJÏùò ÍπäÏùÄ ÌÜµÏ∞∞Î†•Ïù¥ ÎßåÎÇòÎ©¥ Ï†ïÎßê ÌäπÎ≥ÑÌïú ÏùºÎì§Ïù¥ ÏùºÏñ¥ÎÇ† Í±∞ÏòàÏöî!",
                    'ESFJ-ISFP': "Îî∞ÎúªÌï®Ïù¥ 2Î∞∞Í∞Ä ÎêòÎäî Ï°∞Ìï©! ESFJÏùò Î∞∞Î†§Ïã¨Í≥º ISFPÏùò ÏßÑÏ†ïÏÑ±Ïù¥ ÎßåÎÇò ÏÑúÎ°úÎ•º ÎçîÏö± ÎπõÎÇòÍ≤å Ìï¥Ï§Ñ Í±∞ÏòàÏöî.",
                    'ISFP-ESFJ': "Îî∞ÎúªÌï®Ïù¥ 2Î∞∞Í∞Ä ÎêòÎäî Ï°∞Ìï©! ESFJÏùò Î∞∞Î†§Ïã¨Í≥º ISFPÏùò ÏßÑÏ†ïÏÑ±Ïù¥ ÎßåÎÇò ÏÑúÎ°úÎ•º ÎçîÏö± ÎπõÎÇòÍ≤å Ìï¥Ï§Ñ Í±∞ÏòàÏöî.",
                    'ENTJ-INTP': "ÏôÑÎ≤ΩÌïú Î∏åÎ†àÏù∏ ÏΩ§ÎπÑ! ENTJÏùò Ï∂îÏßÑÎ†•Í≥º INTPÏùò ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ÎßåÎÇòÎ©¥ Î∂àÍ∞ÄÎä•Ìïú Í≤å ÏóÜÏñ¥ Î≥¥Ïó¨Ïöî!",
                    'INTP-ENTJ': "ÏôÑÎ≤ΩÌïú Î∏åÎ†àÏù∏ ÏΩ§ÎπÑ! ENTJÏùò Ï∂îÏßÑÎ†•Í≥º INTPÏùò ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ÎßåÎÇòÎ©¥ Î∂àÍ∞ÄÎä•Ìïú Í≤å ÏóÜÏñ¥ Î≥¥Ïó¨Ïöî!"
                };

                if (mbti1 === mbti2) {
                    return "Ï∞êÏπú Îê† ÌôïÎ•† 99%! Í∞ôÏùÄ MBTIÎÅºÎ¶¨Îäî ÏÑúÎ°úÎ•º ÎÑàÎ¨¥ Ïûò Ïù¥Ìï¥Ìï¥ÏÑú Í∏àÏÑ∏ Ìé∏ÏïàÌïú ÏÇ¨Ïù¥Í∞Ä Îê† Í≤É Í∞ôÏïÑÏöî!";
                }

                const key = `${mbti1}-${mbti2}`;
                if (messages[key]) return messages[key];

                if (score >= 80) return "ÏôÄ! Ï†ïÎßê ÌôòÏÉÅÏùò ÏºÄÎØ∏ÎÑ§Ïöî! Ìï®ÍªòÌïòÎ©¥ ÏãúÎÑàÏßÄ Ìè≠Î∞úÌï† Í≤É Í∞ôÏïÑÏöî!";
                if (score >= 60) return "Ï¢ãÏùÄ ÏºÄÎØ∏ÏóêÏöî! Îçî ÏïåÏïÑÍ∞àÏàòÎ°ù ÏºÄÎØ∏Í∞Ä ÏóÖÎê† Í±∞ÏòàÏöî!";
                return "ÏºÄÎØ∏Î•º ÎßûÏ∂∞Í∞ÄÎäî Ïû¨ÎØ∏Í∞Ä ÏûàÎäî Í¥ÄÍ≥ÑÎÑ§Ïöî!";
            };

            const handleSubmit = () => {
                if (!person1.name || !person1.mbti || !person2.name || !person2.mbti) {
                    alert('Î™®Îì† Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                    return;
                }

                setCurrentStep('loading');
                
                setTimeout(() => {
                    const overallScore = calculateChemistry(person1.mbti, person2.mbti);
                    const message = getChemistryMessage(person1.mbti, person2.mbti, overallScore);
                    const detailedScores = getDetailedScores(person1.mbti, person2.mbti);
                    
                    const finalResult = {
                        overall: overallScore,
                        message: message,
                        detailed: detailedScores
                    };
                    
                    setResult(finalResult);
                    saveToHistory(finalResult);
                    
                    if (overallScore >= 90) {
                        setShowCelebration(true);
                        setTimeout(() => setShowCelebration(false), 3000);
                    }
                    
                    setCurrentStep('result');
                }, 2000);
            };

            const resetTest = () => {
                setCurrentStep('input');
                setPerson1({ name: '', mbti: '' });
                setPerson2({ name: '', mbti: '' });
                setResult(null);
                setShowCelebration(false);
            };

            const getScoreColor = (score) => {
                if (score >= 80) return 'text-green-600';
                if (score >= 60) return 'text-blue-600';
                return 'text-orange-600';
            };

            const getScoreEmoji = (score) => {
                if (score >= 90) return 'üèÜ';
                if (score >= 80) return 'üî•';
                if (score >= 60) return '‚ú®';
                return 'üí´';
            };

            // CSV Îã§Ïö¥Î°úÎìú
            const downloadCSV = () => {
                if (testHistory.length === 0) {
                    alert('Îã§Ïö¥Î°úÎìúÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                    return;
                }

                const headers = ['ÎÇ†Ïßú', 'ÏãúÍ∞Ñ', 'Ï≤´Î≤àÏß∏ Ïù¥Î¶Ñ', 'Ï≤´Î≤àÏß∏ MBTI', 'ÎëêÎ≤àÏß∏ Ïù¥Î¶Ñ', 'ÎëêÎ≤àÏß∏ MBTI', 'ÏºÄÎØ∏ Ï†êÏàò'];
                const csvData = testHistory.map(record => [
                    record.date, record.time, record.person1.name, record.person1.mbti,
                    record.person2.name, record.person2.mbti, record.score
                ]);

                const csvContent = [headers, ...csvData]
                    .map(row => row.map(field => `"${field}"`).join(','))
                    .join('\n');

                const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `MBTI_ÏºÄÎØ∏ÌÖåÏä§Ìä∏_Í∏∞Î°ù_${new Date().toLocaleDateString('ko-KR')}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            // URL Ï†ÄÏû• Ìï®Ïàò
            const handleUrlSave = (url) => {
                setGoogleSheetsUrl(url);
                if (url) {
                    localStorage.setItem('googleSheetsUrl', url);
                } else {
                    localStorage.removeItem('googleSheetsUrl');
                }
            };

            // Ï∂ïÌïò Ïï†ÎãàÎ©îÏù¥ÏÖò
            const CelebrationOverlay = () => (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
                    <div className="bg-white rounded-3xl p-8 max-w-sm mx-4 text-center animate-bounce">
                        <div className="text-6xl mb-4">üéâ</div>
                        <div className="text-3xl mb-2">üèÜ</div>
                        <h2 className="text-2xl font-bold text-yellow-600 mb-2">ÌôòÏÉÅÏùò ÏºÄÎØ∏!</h2>
                        <p className="text-gray-700 mb-4">90Ï†ê Ïù¥ÏÉÅÏùò ÎÜÄÎùºÏö¥ Í∂ÅÌï©Ïù¥ÏóêÏöî!</p>
                        <div className="flex justify-center space-x-2">
                            {[...Array(5)].map((_, i) => (
                                <Star key={i} className="w-6 h-6 text-yellow-500 fill-current animate-pulse" />
                            ))}
                        </div>
                    </div>
                </div>
            );

            // ÏÑ§Ï†ï ÌôîÎ©¥
            if (showSettings) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-3xl shadow-xl p-6">
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-xl font-bold text-gray-800 flex items-center">
                                        <Settings className="w-6 h-6 mr-2" />
                                        ÏÑ§Ï†ï
                                    </h2>
                                    <button
                                        onClick={() => setShowSettings(false)}
                                        className="text-gray-500 hover:text-gray-700 text-2xl"
                                    >
                                        ‚úï
                                    </button>
                                </div>
                                
                                <div className="space-y-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Google Sheets Ïó∞Îèô URL (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                                        </label>
                                        <input
                                            type="url"
                                            placeholder="https://script.google.com/macros/s/.../exec"
                                            value={googleSheetsUrl}
                                            onChange={(e) => handleUrlSave(e.target.value)}
                                            className="w-full p-3 border-2 border-gray-200 rounded-2xl focus:border-blue-600 focus:outline-none text-sm"
                                        />
                                        <p className="text-xs text-gray-500 mt-1">
                                            ÏûÖÎ†•ÌïòÎ©¥ Íµ¨Í∏ÄÏãúÌä∏Ïóê ÏûêÎèôÏúºÎ°ú Í∏∞Î°ùÏù¥ Ï†ÄÏû•Îê©ÎãàÎã§
                                        </p>
                                    </div>

                                    <div className="border-t pt-4">
                                        <h3 className="font-medium text-gray-700 mb-3">Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨</h3>
                                        <div className="space-y-3">
                                            <button
                                                onClick={downloadCSV}
                                                className="w-full bg-green-100 text-green-700 font-medium py-3 px-4 rounded-2xl hover:bg-green-200 transition-all flex items-center justify-center"
                                            >
                                                <Download className="w-4 h-4 mr-2" />
                                                CSV ÌååÏùºÎ°ú Îã§Ïö¥Î°úÎìú ({testHistory.length}Í∞ú Í∏∞Î°ù)
                                            </button>
                                            
                                            <button
                                                onClick={() => {
                                                    if (confirm('Ï†ïÎßêÎ°ú Î™®Îì† Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                                                        localStorage.removeItem('mbtiChemistryHistory');
                                                        setTestHistory([]);
                                                        alert('Î™®Îì† Í∏∞Î°ùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                                                    }
                                                }}
                                                className="w-full bg-red-100 text-red-700 font-medium py-3 px-4 rounded-2xl hover:bg-red-200 transition-all"
                                            >
                                                Î™®Îì† Í∏∞Î°ù ÏÇ≠Ï†ú
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <button
                                    onClick={() => setShowSettings(false)}
                                    className="w-full mt-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200"
                                >
                                    ÏôÑÎ£å
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Í∏∞Î°ù Î≥¥Í∏∞ ÌôîÎ©¥
            if (showHistory) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-3xl shadow-xl p-6">
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-xl font-bold text-gray-800 flex items-center">
                                        <List className="w-6 h-6 mr-2" />
                                        ÏºÄÎØ∏ ÌÖåÏä§Ìä∏ Í∏∞Î°ù
                                    </h2>
                                    <div className="flex space-x-2">
                                        <button
                                            onClick={() => setShowSettings(true)}
                                            className="p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-100"
                                            title="ÏÑ§Ï†ï"
                                        >
                                            <Settings className="w-5 h-5" />
                                        </button>
                                        <button
                                            onClick={() => setShowHistory(false)}
                                            className="text-gray-500 hover:text-gray-700 text-xl"
                                        >
                                            ‚úï
                                        </button>
                                    </div>
                                </div>
                                
                                {testHistory.length === 0 ? (
                                    <div className="text-center py-8">
                                        <p className="text-gray-500">ÏïÑÏßÅ ÌÖåÏä§Ìä∏ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥Ïöî</p>
                                    </div>
                                ) : (
                                    <div className="space-y-3 max-h-96 overflow-y-auto">
                                        {testHistory.map((record) => (
                                            <div key={record.id} className="bg-gray-50 rounded-2xl p-4">
                                                <div className="flex items-center justify-between mb-2">
                                                    <div className="flex items-center space-x-2">
                                                        <span className="font-medium text-blue-600">{record.person1.name}</span>
                                                        <span className="text-xs text-gray-500">({record.person1.mbti})</span>
                                                        <Heart className="w-4 h-4 text-red-500" />
                                                        <span className="font-medium text-purple-600">{record.person2.name}</span>
                                                        <span className="text-xs text-gray-500">({record.person2.mbti})</span>
                                                    </div>
                                                    <span className={`font-bold ${getScoreColor(record.score)}`}>
                                                        {record.score}Ï†ê {getScoreEmoji(record.score)}
                                                    </span>
                                                </div>
                                                <div className="text-xs text-gray-500">
                                                    {record.date} {record.time}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                                
                                <button
                                    onClick={() => setShowHistory(false)}
                                    className="w-full mt-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200"
                                >
                                    ÎèåÏïÑÍ∞ÄÍ∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Î°úÎî© ÌôîÎ©¥
            if (currentStep === 'loading') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl shadow-xl p-8 max-w-md w-full text-center">
                            <div className="animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent mx-auto mb-6"></div>
                            <h2 className="text-xl font-bold text-gray-800 mb-2">ÏºÄÎØ∏ Î∂ÑÏÑù Ï§ë...</h2>
                            <p className="text-gray-600">Îëê Î∂ÑÏùò ÌäπÎ≥ÑÌïú ÏºÄÎØ∏Î•º ÌôïÏù∏ÌïòÍ≥† ÏûàÏñ¥Ïöî!</p>
                        </div>
                    </div>
                );
            }

            // Í≤∞Í≥º ÌôîÎ©¥
            if (currentStep === 'result') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4">
                        {showCelebration && <CelebrationOverlay />}
                        <div className="max-w-md mx-auto">
                            {/* Ï†ÑÏ≤¥ ÏºÄÎØ∏ Ï†êÏàò */}
                            <div className="bg-white rounded-3xl shadow-xl p-6 mb-6">
                                <div className="text-center mb-6">
                                    <div className="flex items-center justify-center mb-4">
                                        <Sparkles className="w-8 h-8 text-yellow-500 mr-2" />
                                        <h1 className="text-2xl font-bold text-gray-800">ÏºÄÎØ∏ Î∂ÑÏÑù Í≤∞Í≥º</h1>
                                        <button
                                            onClick={() => setShowHistory(true)}
                                            className="ml-4 p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-100"
                                            title="Í∏∞Î°ù Î≥¥Í∏∞"
                                        >
                                            <List className="w-5 h-5" />
                                        </button>
                                    </div>
                                    <div className="flex items-center justify-center space-x-2 mb-2">
                                        <span className="text-lg font-semibold text-blue-600">{person1.name}</span>
                                        <span className="text-sm text-gray-500">({person1.mbti})</span>
                                        <Heart className="w-5 h-5 text-red-500" />
                                        <span className="text-lg font-semibold text-blue-600">{person2.name}</span>
                                        <span className="text-sm text-gray-500">({person2.mbti})</span>
                                    </div>
                                </div>
                                
                                <div className="text-center mb-6">
                                    {result.overall >= 90 && (
                                        <div className="mb-4">
                                            <div className="text-4xl mb-2">üéâüèÜüéâ</div>
                                            <div className="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-4 py-2 rounded-full inline-block text-sm font-bold">
                                                PERFECT MATCH!
                                            </div>
                                        </div>
                                    )}
                                    <div className={`text-5xl font-bold ${getScoreColor(result.overall)} mb-2`}>
                                        {result.overall}Ï†ê {getScoreEmoji(result.overall)}
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-3 mb-4">
                                        <div 
                                            className="bg-gradient-to-r from-blue-600 to-purple-600 h-3 rounded-full transition-all duration-1000"
                                            style={{ width: `${result.overall}%` }}
                                        ></div>
                                    </div>
                                    <p className="text-gray-700 leading-relaxed">{result.message}</p>
                                </div>
                            </div>

                            {/* ÏÑ∏Î∂Ä ÏòÅÏó≠Î≥Ñ Ï†êÏàò */}
                            <div className="space-y-4 mb-6">
                                {[
                                    { key: 'travel', icon: MapPin, label: 'Ïó¨Ìñâ ÎèôÎ∞òÏûê ÏºÄÎØ∏', color: 'from-green-500 to-emerald-600' },
                                    { key: 'faith', icon: BookOpen, label: 'Ïã†Ïïô ÏÑ±Ïû• ÌååÌä∏ÎÑà ÏºÄÎØ∏', color: 'from-blue-500 to-indigo-600' },
                                    { key: 'conversation', icon: MessageCircle, label: 'ÏùºÏÉÅ ÎåÄÌôî ÌååÌä∏ÎÑà ÏºÄÎØ∏', color: 'from-purple-500 to-pink-600' },
                                    { key: 'teamwork', icon: Users, label: 'ÏÜåÍ∑∏Î£π ÌôúÎèô ÌååÌä∏ÎÑà ÏºÄÎØ∏', color: 'from-orange-500 to-red-600' },
                                    { key: 'service', icon: HandHeart, label: 'Î¥âÏÇ¨ ÎèôÏó≠Ïûê ÏºÄÎØ∏', color: 'from-teal-500 to-cyan-600' }
                                ].map(({ key, icon: Icon, label, color }) => (
                                    <div key={key} className="bg-white rounded-2xl shadow-lg p-4">
                                        <div className="flex items-center justify-between mb-3">
                                            <div className="flex items-center">
                                                <Icon className="w-5 h-5 text-gray-600 mr-2" />
                                                <span className="font-medium text-gray-800">{label}</span>
                                            </div>
                                            <span className={`font-bold ${getScoreColor(result.detailed[key])}`}>
                                                {result.detailed[key]}Ï†ê
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2">
                                            <div 
                                                className={`bg-gradient-to-r ${color} h-2 rounded-full transition-all duration-1000`}
                                                style={{ width: `${result.detailed[key]}%` }}
                                            ></div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <div className="flex space-x-3">
                                <button
                                    onClick={resetTest}
                                    className="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg"
                                >
                                    Îã§Ïãú ÌÖåÏä§Ìä∏ÌïòÍ∏∞
                                </button>
                                <button
                                    onClick={() => {
                                        if (navigator.share) {
                                            navigator.share({
                                                title: 'MBTI ÏºÄÎØ∏ Ï≤¥ÌÅ¨ Í≤∞Í≥º',
                                                text: `${person1.name}(${person1.mbti})ÎãòÍ≥º ${person2.name}(${person2.mbti})ÎãòÏùò ÏºÄÎØ∏Îäî ${result.overall}Ï†ê!`,
                                            });
                                        } else {
                                            const text = `${person1.name}(${person1.mbti})ÎãòÍ≥º ${person2.name}(${person2.mbti})ÎãòÏùò ÏºÄÎØ∏Îäî ${result.overall}Ï†ê! üî•`;
                                            navigator.clipboard.writeText(text);
                                            alert('Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
                                        }
                                    }}
                                    className="bg-white border-2 border-blue-600 text-blue-600 font-bold py-3 px-6 rounded-2xl hover:bg-blue-50 transition-all duration-200 shadow-lg"
                                >
                                    Í≥µÏú†ÌïòÍ∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Î©îÏù∏ ÏûÖÎ†• ÌôîÎ©¥
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4">
                    <div className="max-w-md mx-auto">
                        {/* Ìó§Îçî */}
                        <div className="text-center mb-8 pt-8">
                            <div className="flex items-center justify-center mb-4">
                                <Heart className="w-8 h-8 text-red-500 mr-2" />
                                <h1 className="text-3xl font-bold text-gray-800">MBTI ÏºÄÎØ∏ Ï≤¥ÌÅ¨</h1>
                                <div className="flex ml-4 space-x-2">
                                    <button
                                        onClick={() => setShowHistory(true)}
                                        className="p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-white hover:shadow-md transition-all cursor-pointer"
                                        title="Í∏∞Î°ù Î≥¥Í∏∞"
                                    >
                                        <List className="w-6 h-6" />
                                    </button>
                                    <button
                                        onClick={() => setShowSettings(true)}
                                        className="p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-white hover:shadow-md transition-all cursor-pointer"
                                        title="ÏÑ§Ï†ï"
                                    >
                                        <Settings className="w-6 h-6" />
                                    </button>
                                </div>
                            </div>
                            <p className="text-gray-600">Îëê ÏÇ¨ÎûåÏùò ÌäπÎ≥ÑÌïú ÏºÄÎØ∏Î•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                            {testHistory.length > 0 && (
                                <p className="text-sm text-blue-600 mt-2">üíæ {testHistory.length}Í∞úÏùò ÌÖåÏä§Ìä∏ Í∏∞Î°ùÏù¥ ÏûàÏñ¥Ïöî</p>
                            )}
                        </div>

                        {/* ÏûÖÎ†• Ìèº */}
                        <div className="bg-white rounded-3xl shadow-xl p-6 mb-6">
                            {/* Ï≤´ Î≤àÏß∏ ÏÇ¨Îûå */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                    <span className="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-2">1</span>
                                    Ï≤´ Î≤àÏß∏ Î∂Ñ
                                </h3>
                                <div className="space-y-4">
                                    <input
                                        type="text"
                                        placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
                                        value={person1.name}
                                        onChange={(e) => setPerson1({ ...person1, name: e.target.value })}
                                        className="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-blue-600 focus:outline-none transition-colors"
                                    />
                                    <select
                                        value={person1.mbti}
                                        onChange={(e) => setPerson1({ ...person1, mbti: e.target.value })}
                                        className="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-blue-600 focus:outline-none transition-colors"
                                    >
                                        <option value="">MBTI Ïú†ÌòïÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                                        {mbtiTypes.map(type => (
                                            <option key={type} value={type}>{type}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>

                            {/* Îëê Î≤àÏß∏ ÏÇ¨Îûå */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                    <span className="bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-2">2</span>
                                    Îëê Î≤àÏß∏ Î∂Ñ
                                </h3>
                                <div className="space-y-4">
                                    <input
                                        type="text"
                                        placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
                                        value={person2.name}
                                        onChange={(e) => setPerson2({ ...person2, name: e.target.value })}
                                        className="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-purple-600 focus:outline-none transition-colors"
                                    />
                                    <select
                                        value={person2.mbti}
                                        onChange={(e) => setPerson2({ ...person2, mbti: e.target.value })}
                                        className="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-purple-600 focus:outline-none transition-colors"
                                    >
                                        <option value="">MBTI Ïú†ÌòïÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                                        {mbtiTypes.map(type => (
                                            <option key={type} value={type}>{type}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>

                            <button
                                onClick={handleSubmit}
                                className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-4 px-6 rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg flex items-center justify-center cursor-pointer"
                            >
                                ÏºÄÎØ∏ ÌôïÏù∏ÌïòÍ∏∞
                                <ArrowRight className="w-5 h-5 ml-2" />
                            </button>
                        </div>

                        {/* ÏÑ§Î™Ö */}
                        <div className="bg-white/70 backdrop-blur-sm rounded-2xl p-4 text-center">
                            <p className="text-sm text-gray-600">
                                üéØ 5Í∞ú ÏòÅÏó≠Î≥Ñ ÏÑ∏Î∂Ä ÏºÄÎØ∏ Î∂ÑÏÑù<br />
                                üí´ MBTI Ï°∞Ìï©Î≥Ñ ÎßûÏ∂§ Î©îÏãúÏßÄ<br />
                                üíù ÍµêÌöå Í≥µÎèôÏ≤¥Î•º ÏúÑÌïú ÌäπÎ≥ÑÌïú ÏºÄÎØ∏ Ï≤¥ÌÅ¨
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Ïï± Î†åÎçîÎßÅ
        ReactDOM.render(React.createElement(MBTIChemistryChecker), document.getElementById('root'));
    </script>
</body>
</html>
